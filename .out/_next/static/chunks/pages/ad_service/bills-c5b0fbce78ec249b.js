(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{6795:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ad_service/bills",function(){return n(7031)}])},8134:function(t,e,n){"use strict";n.d(e,{q:function(){return a}});let a={apiKey:"AIzaSyAvG04eeCLcb6VBF7F61x7H-3zyTTBQfjM",authDomain:"tableorderservice.firebaseapp.com",projectId:"tableorderservice",storageBucket:"tableorderservice.appspot.com",messagingSenderId:"789767582873",appId:"1:789767582873:web:c0cc47801fff8ba1b8f408",measurementId:"G-25TT028B48"}},7031:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return S}});var a=n(5893),i=n(7294),r=n(5861),s=n(6886),c=n(1903),l=n(9417),o=n(7906),h=n(3184),d=n(3816),u=n(8102),f=n(295),m=n(7789),p=n(4422),g=n(3977),x=n(9828),j=n(8134),y=n(454);class Z{constructor(t,e,n,a,i="",r=!0){this.menu_id=t,this.menu_name=e,this.orderdetails_price=n,this.quantity=a,this.note=i,this.itemstatus=r}}class b{constructor(t,e,n,a,i,r){this.id=t,this.items=e,this.date=n,this.paymentStatus=a,this.tableId=i,this.totalPrice=r}}var S=()=>{let{bills:t,noDataMessage:e}=function(){let[t,e]=(0,i.useState)([]),[n,a]=(0,i.useState)("");return(0,i.useEffect)(()=>{(async()=>{try{let t=(0,g.ZF)(j.q),n=(0,x.ad)(t),i=(0,x.hJ)(n,"Bills"),r=await (0,x.PL)(i),s=[];r.forEach(t=>{let{id:e,items:n,date:a,paymentStatus:i,totalPrice:r,tableId:c}=t.data(),l=n.map(t=>new Z(t.menu_id,t.menu_name,t.orderdetails_price,t.quantity,t.note,t.itemstatus)),o=(0,y.Qc)(a,"d/M/yyyy H:m:s",new Date),h=new b(e,l,o,i,c,r);s.push(h)}),0===s.length?a("No bills found."):a(""),e(s)}catch(t){console.error("Error fetching bills: ",t)}})()},[]),{bills:t,noDataMessage:n}}(),[n,S]=(0,i.useState)(null),[_,v]=(0,i.useState)(null),[w,T]=(0,i.useState)([]),[D,k]=(0,i.useState)(""),[C,I]=(0,i.useState)([]);(0,i.useEffect)(()=>{I([...t].reverse())},[t]);let P=t=>{S(t)},E=t=>{v(t)},L=t=>{let e="Date: ".concat(t.date.toLocaleString(),"\n");e+="Tổng tiền: ".concat(t.totalPrice,"\n")+"Trạng th\xe1i: ".concat(t.paymentStatus?"Đ\xe3 thanh to\xe1n":"Chưa thanh to\xe1n","\n")+"Chi tiết đơn h\xe0ng:\n",t.items.forEach((t,n)=>{e+="".concat(n+1,". ").concat(t.menu_name," x ").concat(t.quantity," - ").concat(t.orderdetails_price,"\n")}),window.confirm(e)};return e?(0,a.jsx)(r.Z,{children:e}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.ZP,{container:!0,spacing:2,alignItems:"center",children:[(0,a.jsx)(s.ZP,{item:!0,children:(0,a.jsx)(c.Z,{id:"startDate",label:"Start Date",type:"date",value:n?n.toISOString().split("T")[0]:"",onChange:t=>P(new Date(t.target.value)),InputLabelProps:{shrink:!0}})}),(0,a.jsx)(s.ZP,{item:!0,children:(0,a.jsx)(c.Z,{id:"endDate",label:"End Date",type:"date",value:_?_.toISOString().split("T")[0]:"",onChange:t=>E(new Date(t.target.value)),InputLabelProps:{shrink:!0}})}),(0,a.jsx)(s.ZP,{item:!0,children:(0,a.jsx)(l.Z,{variant:"contained",color:"primary",startIcon:(0,a.jsx)(m.Z,{}),onClick:()=>{if(n&&_){if(n>_){alert("Thời gian kh\xf4ng hợp lệ: Ng\xe0y bắt đầu phải nhỏ hơn ng\xe0y kết th\xfac");return}let e=t.filter(t=>{let e=new Date(t.date);return e>=n&&e<=_});T(e),k("Danh s\xe1ch h\xf3a đơn từ ng\xe0y ".concat(n.toLocaleDateString()," đến ng\xe0y ").concat(_.toLocaleDateString())),I(e)}else T([]),k(""),I([...t].reverse())},children:"Lọc"})}),(0,a.jsx)(s.ZP,{item:!0,children:(0,a.jsx)(l.Z,{variant:"contained",color:"secondary",startIcon:(0,a.jsx)(p.Z,{}),onClick:()=>{S(null),v(null),T([]),k(""),I([...t].reverse())},children:"Hủy Lọc"})})]}),(0,a.jsx)(r.Z,{variant:"h4",children:D}),(0,a.jsxs)(o.Z,{sx:{marginTop:"10px"},children:[(0,a.jsx)(h.Z,{children:(0,a.jsxs)(d.Z,{style:{backgroundColor:"#f2f2f2"},children:[(0,a.jsx)(u.Z,{children:"Ng\xe0y"}),(0,a.jsx)(u.Z,{children:"Tổng Tiền"}),(0,a.jsx)(u.Z,{children:"Trạng Th\xe1i"}),(0,a.jsx)(u.Z,{})]})}),(0,a.jsx)(f.Z,{children:C.sort((t,e)=>new Date(e.date).getTime()-new Date(t.date).getTime()).map((t,e)=>(0,a.jsxs)(d.Z,{style:{backgroundColor:e%2==0?"#ffffff":"#f2f2f2"},children:[(0,a.jsx)(u.Z,{children:t.date.toLocaleString()}),(0,a.jsx)(u.Z,{children:"".concat(t.totalPrice," VNĐ")}),(0,a.jsx)(u.Z,{children:t.paymentStatus?"Đ\xe3 thanh to\xe1n":"Chưa thanh to\xe1n"}),(0,a.jsx)(u.Z,{children:(0,a.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>L(t),children:"Xem chi tiết"})})]},t.id))})]})]})}}},function(t){t.O(0,[16,474,945,903,886,365,554,888,774,179],function(){return t(t.s=6795)}),_N_E=t.O()}]);